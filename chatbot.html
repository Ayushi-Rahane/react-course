<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChatBot</title>
</head>
<body>
    <div class="container"></div>

    <script src="https://unpkg.com/supersimpledev/react.js"></script>
    <script src="https://unpkg.com/supersimpledev/react-dom.js"></script>
    <script src="https://unpkg.com/supersimpledev/chatbot.js"></script>
    <script src="https://unpkg.com/supersimpledev/babel.js  "></script>

    <script type="text/babel">
      function ChatInput({setChatMsgs, chatMsgs}){

        const[inputMsg, setInputMsg] = React.useState("");
        function setInputValue(event){
            setInputMsg(event.target.value);
        }
        function sendMsg(){
            const newChatMsgs =[
                ...chatMsgs,
                {
                    msg:inputMsg,
                    sender:"user",
                    id:crypto.randomUUID()
 
                }
            ];
            setChatMsgs(
                newChatMsgs
            );
           const response = Chatbot.getResponse(inputMsg);
         
             setChatMsgs(
                [
                ...newChatMsgs,
                {
                    msg:response,
                    sender:"robot",
                    id:crypto.randomUUID()
 
                }
            ]
          );
            setInputMsg("");
        }
        return(
           <> {/*React Fragment: won't let us use extra div */}
                <input 
                    placeholder="Send a message to Chatbot" 
                    size="40"
                    onChange={setInputValue}
                    value={inputMsg}
                />
                <button onClick={sendMsg}>Send</button>
           </>
        );
       }

       function ChatMessage(props){
     //   const msg = props.message;
       // const img_src = props.img_src;

       const {msg} = props;
       const {sender} = props;

    /*. it's shortcut is giving below using guard operator: && 
      if(sender=="robot"){
        return (
             <div>
                <img src="robot.png" 
                alt="chatbot image" width="50" />
                 {msg}
            </div>
        );
       }*/
        return(
            <div>
                {sender==='robot' && 
                    (
                    <img 
                        src="robot.png" 
                        alt="chatbot image" 
                        width="50" 
                    />
                    )
                }

                {msg}

                {sender==='user' && 
                    (   
                        <img 
                            src="user.png" 
                            alt="chatbot image" 
                            width="50" 
                        />
                    )
                }
            </div>
        );
       }
   function ChatMsgs(props){
  
        return(
            <>
            
              {props.chatMsgs.map((chatmsg) =>{
                 return(
                    <ChatMessage 
                        msg={chatmsg.msg} 
                        sender={chatmsg.sender}
                        key={chatmsg.id}
                    />
                    )
                })
            }
            </>
        );
     }
     function App(){
              const [chatMsgs, setChatMsgs] = React.useState(
            [
            {
              msg:"hello chatbot!",
              sender:"user",
              id:'id1'
            },
            {
                msg:"hello user!",
                sender:"robot",
                id:'id2'
            }
        ]
        );
     // const [chatMsgs, setChatMsgs] = array;
      // const chatMsgs = array[0];
      // const setChatMsgs = array[1];
       
          return(
             <>
              <ChatInput chatMsgs={chatMsgs} setChatMsgs={setChatMsgs}/>
              <ChatMsgs 
              chatMsgs={chatMsgs}
              />
           </>
          );
     }
      
      const cont = document.querySelector(".container");
      ReactDOM.createRoot(cont).render(<App/>);
    </script>


</body>
</html>